import{e as k,f as j,g as L,h as d,i as s,q as B,r as W}from"./chunk-IGED4TOA.js";import{M as H,N as T}from"./chunk-Q6UHPJXR.js";import{R as z,X as F,sa as S,u as w}from"./chunk-7TD4AYMG.js";function A(e,t,n){let r=s(e,n?.in);return isNaN(t)?d(n?.in||e,NaN):(t&&r.setDate(r.getDate()+t),r)}function C(e,t,n){let r=s(e,n?.in);if(isNaN(t))return d(n?.in||e,NaN);if(!t)return r;let o=r.getDate(),i=d(n?.in||e,r.getTime());i.setMonth(r.getMonth()+t+1,0);let a=i.getDate();return o>=a?i:(r.setFullYear(i.getFullYear(),i.getMonth(),o),r)}function g(e,t,n){let{years:r=0,months:o=0,weeks:i=0,days:a=0,hours:f=0,minutes:c=0,seconds:l=0}=t,h=s(e,n?.in),D=o||r?C(h,o+r*12):h,y=a||i?A(D,a+i*7):D,x=c+f*60,b=(l+x*60)*1e3;return d(n?.in||e,+y+b)}function R(e){let t=s(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function u(e,...t){let n=d.bind(null,e||t.find(r=>typeof r=="object"));return t.map(n)}function _(e,t){let n=s(e,t?.in);return n.setHours(0,0,0,0),n}function P(e,t,n){let[r,o]=u(n?.in,e,t),i=_(r),a=_(o),f=+i-R(i),c=+a-R(a);return Math.round((f-c)/k)}function p(e,t){let n=+s(e)-+s(t);return n<0?-1:n>0?1:n}function U(e,t,n){let[r,o]=u(n?.in,e,t),i=r.getFullYear()-o.getFullYear(),a=r.getMonth()-o.getMonth();return i*12+a}function $(e,t,n){let[r,o]=u(n?.in,e,t);return r.getFullYear()-o.getFullYear()}function q(e,t,n){let[r,o]=u(n?.in,e,t),i=E(r,o),a=Math.abs(P(r,o));r.setDate(r.getDate()-i*a);let f=+(E(r,o)===-i),c=i*(a-f);return c===0?0:c}function E(e,t){let n=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return n<0?-1:n>0?1:n}function M(e){return t=>{let r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function G(e,t,n){let[r,o]=u(n?.in,e,t),i=(+r-+o)/L;return M(n?.roundingMethod)(i)}function I(e,t){return+s(e)-+s(t)}function J(e,t,n){let r=I(e,t)/j;return M(n?.roundingMethod)(r)}function K(e,t){let n=s(e,t?.in);return n.setHours(23,59,59,999),n}function Q(e,t){let n=s(e,t?.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function V(e,t){let n=s(e,t?.in);return+K(n,t)==+Q(n,t)}function X(e,t,n){let[r,o,i]=u(n?.in,e,e,t),a=p(o,i),f=Math.abs(U(o,i));if(f<1)return 0;o.getMonth()===1&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-a*f);let c=p(o,i)===-a;V(r)&&f===1&&p(r,i)===1&&(c=!1);let l=a*(f-+c);return l===0?0:l}function Z(e,t,n){let r=I(e,t)/1e3;return M(n?.roundingMethod)(r)}function ee(e,t,n){let[r,o]=u(n?.in,e,t),i=p(r,o),a=Math.abs($(r,o));r.setFullYear(1584),o.setFullYear(1584);let f=p(r,o)===-i,c=i*(a-+f);return c===0?0:c}function te(e,t){let[n,r]=u(e,t.start,t.end);return{start:n,end:r}}function v(e,t){let{start:n,end:r}=te(t?.in,e),o={},i=ee(r,n);i&&(o.years=i);let a=g(n,{years:o.years}),f=X(r,a);f&&(o.months=f);let c=g(a,{months:o.months}),l=q(r,c);l&&(o.days=l);let h=g(c,{days:o.days}),D=G(r,h);D&&(o.hours=D);let y=g(h,{hours:o.hours}),x=J(r,y);x&&(o.minutes=x);let O=g(y,{minutes:o.minutes}),b=Z(r,O);return b&&(o.seconds=b),o}function _t(e,t){if(!e||!t)return"--:--:--";let n=v({end:t,start:e});return N(n)}function vt(e){if(!e)return"--:--:--";let t=v({end:e,start:new Date});return N(t)}function Yt(e){if(!e||e<0)return"--:--:--";let t=Math.floor(e/1e3),n={hours:Math.floor(t/3600),minutes:Math.floor(t%3600/60),seconds:t%60};return N(n)}function Ot(e){if(!e||e<0)return"--:--:--";let t=Math.floor(e/1e3),n={hours:Math.floor(t/3600),minutes:Math.floor(t%3600/60),seconds:t%60};return N(n)}function wt(e){if(!e||e<0)return"--:--:--.---";let t=Math.floor(e/1e3),n=e%1e3,r={hours:Math.floor(t/3600),minutes:Math.floor(t%3600/60),seconds:t%60};return oe(r,n)}function zt(e){if(!e||e<0)return"--:--.---";let t=Math.floor(e/1e3),n=e%1e3,r={hours:Math.floor(t/3600),minutes:Math.floor(t%3600/60),seconds:t%60};return ie(r,n)}function Ht(e){if(!e||e<0)return"--:--";let t=Math.floor(e/1e3),n={minutes:Math.floor(t%3600/60),seconds:t%60};return re(n)}function kt(e){if(!e||e<0)return"--.---";let t=Math.floor(e/1e3),n=e%1e3,r={minutes:Math.floor(t%3600/60),seconds:t%60};return se(r,n)}function re(e){return e.minutes&&e.minutes<0||e.seconds&&e.seconds<0?"--:--":[m(e.minutes),m(e.seconds)].join(":")}function N(e){return e.hours&&e.hours<0||e.minutes&&e.minutes<0||e.seconds&&e.seconds<0?"--:--:--":[m(e.hours),m(e.minutes),m(e.seconds)].join(":")}function oe(e,t){return e.hours&&e.hours<0||e.minutes&&e.minutes<0||e.seconds&&e.seconds<0?"--:--:--":[[m(e.hours),m(e.minutes),m(e.seconds)].join(":"),Y(t)].join(".")}function ie(e,t){return e.minutes&&e.minutes<0||e.seconds&&e.seconds<0?"--:--.---":[[m(e.minutes),m(e.seconds)].join(":"),Y(t)].join(".")}function se(e,t){return e.seconds&&e.seconds<0?"--.---":[m(e.seconds),Y(t)].join(".")}function m(e){return e?e<10?`0${e}`:`${e}`:"00"}function Y(e){return e<10?`00${e}`:e<100?`0${e}`:`${e}`}var ne=class e{teamService=F(B);lapService=F(W);worker;racePositionByRaceNumber=S(new Map);teamRacePosition=S(void 0);firstTeamRaceNumber=S(void 0);constructor(){typeof Worker<"u"&&(this.worker=new Worker(new URL("worker-UD5IO3FS.js",import.meta.url),{type:"module"}),this.worker.onmessage=({data:t})=>{this.racePositionByRaceNumber.set(t.racePositionByRaceNumber),this.teamRacePosition.set(t.teamRacePosition),this.firstTeamRaceNumber.set(t.firstTeamRaceNumber)}),w({cumulatedTimeByRaceNumber:T(this.lapService.cumulatedTimeByRaceNumber),lastLapNumberByRaceNumber:T(this.lapService.lastLapNumberByRaceNumber),activeTeam:T(this.teamService.activeTeam)}).pipe(H()).subscribe(({cumulatedTimeByRaceNumber:t,lastLapNumberByRaceNumber:n,activeTeam:r})=>{this.worker&&this.worker.postMessage({cumulatedTimeByRaceNumber:t,lastLapNumberByRaceNumber:n,activeTeam:r})})}static \u0275fac=function(n){return new(n||e)};static \u0275prov=z({token:e,factory:e.\u0275fac,providedIn:"root"})};export{P as a,Z as b,_t as c,vt as d,Yt as e,Ot as f,wt as g,zt as h,Ht as i,kt as j,ne as k};
