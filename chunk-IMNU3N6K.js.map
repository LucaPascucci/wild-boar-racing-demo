{
  "version": 3,
  "sources": ["src/app/steering-wheel/service/steering-wheel-config.service.ts"],
  "sourcesContent": ["import { Injectable, signal, WritableSignal } from '@angular/core';\nimport { FirestoreService } from '../../shared/service/firestore.service';\nimport { collection, collectionData } from '@angular/fire/firestore';\nimport { SteeringWheelConfig } from '../model/steering-wheel-config';\nimport { takeUntilDestroyed } from '@angular/core/rxjs-interop';\nimport { map, Observable, takeUntil } from 'rxjs';\nimport { DocumentData } from '@angular/fire/compat/firestore';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SteeringWheelConfigService extends FirestoreService {\n\n  protected collectionPath: string = '/steering-wheel-configs';\n  protected collectionRef = collection(this.firestore, this.collectionPath);\n\n  readonly steeringWheelConfig: WritableSignal<SteeringWheelConfig | undefined> = signal(undefined);\n\n  constructor() {\n    super();\n\n    this.getAll()\n    .pipe(takeUntilDestroyed())\n    .subscribe(configs => {\n      if (configs.length > 0) {\n        this.steeringWheelConfig.set(configs.at(0));\n      }\n    });\n  }\n\n  updateMessageDurationSeconds(value: number) {\n    const config = this.steeringWheelConfig();\n    if (config) {\n      config.messageDurationSeconds = value;\n      this.updateDataWithMessage(config.id, config, 'message duration');\n    }\n  }\n\n  updateMessageInvertColorIntervalMilliseconds(value: number) {\n    const config = this.steeringWheelConfig();\n    if (config) {\n      config.messageInvertColorIntervalMilliseconds = value;\n      this.updateDataWithMessage(config.id, config, 'message invert color interval');\n    }\n  }\n\n  private getAll(): Observable<SteeringWheelConfig[]> {\n    return collectionData(this.collectionRef).pipe(\n      takeUntil(this.destroyed),\n      map((data: DocumentData[]) => data.map(doc => doc as SteeringWheelConfig).filter(config => !config.deleted))\n    );\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAWM,IAAO,6BAAP,MAAO,oCAAmC,iBAAgB;EAEpD,iBAAyB;EACzB,gBAAgB,WAAW,KAAK,WAAW,KAAK,cAAc;EAE/D,sBAAuE,OAAO,MAAS;EAEhG,cAAA;AACE,UAAK;AAEL,SAAK,OAAM,EACV,KAAK,mBAAkB,CAAE,EACzB,UAAU,aAAU;AACnB,UAAI,QAAQ,SAAS,GAAG;AACtB,aAAK,oBAAoB,IAAI,QAAQ,GAAG,CAAC,CAAC;MAC5C;IACF,CAAC;EACH;EAEA,6BAA6B,OAAa;AACxC,UAAM,SAAS,KAAK,oBAAmB;AACvC,QAAI,QAAQ;AACV,aAAO,yBAAyB;AAChC,WAAK,sBAAsB,OAAO,IAAI,QAAQ,kBAAkB;IAClE;EACF;EAEA,6CAA6C,OAAa;AACxD,UAAM,SAAS,KAAK,oBAAmB;AACvC,QAAI,QAAQ;AACV,aAAO,yCAAyC;AAChD,WAAK,sBAAsB,OAAO,IAAI,QAAQ,+BAA+B;IAC/E;EACF;EAEQ,SAAM;AACZ,WAAO,eAAe,KAAK,aAAa,EAAE,KACxC,UAAU,KAAK,SAAS,GACxB,IAAI,CAAC,SAAyB,KAAK,IAAI,SAAO,GAA0B,EAAE,OAAO,YAAU,CAAC,OAAO,OAAO,CAAC,CAAC;EAEhH;;qCAxCW,6BAA0B;EAAA;4EAA1B,6BAA0B,SAA1B,4BAA0B,WAAA,YAFzB,OAAM,CAAA;;;sEAEP,4BAA0B,CAAA;UAHtC;WAAW;MACV,YAAY;KACb;;;",
  "names": []
}
