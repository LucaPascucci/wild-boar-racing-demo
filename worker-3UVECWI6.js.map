{
  "version": 3,
  "sources": ["src/app/race-simulator/service/race-simulator.worker.ts"],
  "sourcesContent": ["/// <reference lib=\"webworker\" />\n\naddEventListener('message', ({ data }) => {\n  const virtualLastCumulatedTimeByRaceNumber = data.virtualLastCumulatedTimeByRaceNumber as Map<number, number>;\n  const remainingPitTimeMillisecondsByRaceNumber = data.remainingPitTimeMillisecondsByRaceNumber as Map<number, number>;\n\n  const virtualRacePositionByRaceNumber = calculateVirtualRacePositionByRaceNumber(\n    virtualLastCumulatedTimeByRaceNumber,\n    remainingPitTimeMillisecondsByRaceNumber,\n  );\n\n  postMessage({\n    virtualRacePositionByRaceNumber: virtualRacePositionByRaceNumber,\n  });\n});\n\nfunction calculateVirtualRacePositionByRaceNumber(\n  virtualLastCumulatedTimeByRaceNumber: Map<number, number>,\n  remainingPitTimeMillisecondsByRaceNumber: Map<number, number>,\n): Map<number,number> {\n  const result = new Map<number, number>();\n\n  const raceNumbers = Array.from(virtualLastCumulatedTimeByRaceNumber.keys());\n\n  const totalVirtualTimeByRaceNumber: Map<number, number> = new Map<number, number>();\n  for (const raceNumber of raceNumbers) {\n    const virtualLastCumulatedTime = virtualLastCumulatedTimeByRaceNumber.get(raceNumber);\n    const remainingPitTimeMilliseconds = remainingPitTimeMillisecondsByRaceNumber.get(raceNumber) || 0;\n    if (virtualLastCumulatedTime) {\n      totalVirtualTimeByRaceNumber.set(raceNumber, virtualLastCumulatedTime + remainingPitTimeMilliseconds);\n    }\n  }\n\n  const sortedRaceNumbers = Array.from(totalVirtualTimeByRaceNumber.entries())\n    .sort(([, timeA], [, timeB]) => timeA - timeB)\n    .map(([raceNumber]) => raceNumber);\n\n  sortedRaceNumbers.forEach((raceNumber, index) => {\n    result.set(raceNumber, index + 1); // Position starts from 1\n  });\n\n  return result;\n}\n"],
  "mappings": ";AAEA,iBAAiB,WAAW,CAAC,EAAE,KAAK,MAAM;AACxC,QAAM,uCAAuC,KAAK;AAClD,QAAM,2CAA2C,KAAK;AAEtD,QAAM,kCAAkC;AAAA,IACtC;AAAA,IACA;AAAA,EACF;AAEA,cAAY;AAAA,IACV;AAAA,EACF,CAAC;AACH,CAAC;AAED,SAAS,yCACP,sCACA,0CACoB;AACpB,QAAM,SAAS,oBAAI,IAAoB;AAEvC,QAAM,cAAc,MAAM,KAAK,qCAAqC,KAAK,CAAC;AAE1E,QAAM,+BAAoD,oBAAI,IAAoB;AAClF,aAAW,cAAc,aAAa;AACpC,UAAM,2BAA2B,qCAAqC,IAAI,UAAU;AACpF,UAAM,+BAA+B,yCAAyC,IAAI,UAAU,KAAK;AACjG,QAAI,0BAA0B;AAC5B,mCAA6B,IAAI,YAAY,2BAA2B,4BAA4B;AAAA,IACtG;AAAA,EACF;AAEA,QAAM,oBAAoB,MAAM,KAAK,6BAA6B,QAAQ,CAAC,EACxE,KAAK,CAAC,CAAC,EAAE,KAAK,GAAG,CAAC,EAAE,KAAK,MAAM,QAAQ,KAAK,EAC5C,IAAI,CAAC,CAAC,UAAU,MAAM,UAAU;AAEnC,oBAAkB,QAAQ,CAAC,YAAY,UAAU;AAC/C,WAAO,IAAI,YAAY,QAAQ,CAAC;AAAA,EAClC,CAAC;AAED,SAAO;AACT;",
  "names": []
}
