var y=Math.pow(10,8)*24*60*60*1e3,h=-y;var M=6e4;var g=1e3;var B=3600;var x=B*24,T=x*7,P=x*365.2425,R=P/12,D=R*3,L=Symbol.for("constructDateFrom");function I(t){return Math.trunc(t*M)}function l(t){return t*g}addEventListener("message",({data:t})=>{let u=t.pitLaps,e=t.pacesByRaceNumber,n=t.pitConfig,r=t.driverConfig,o=t.lapSimulatorConfig.timeLostThroughPitMilliseconds,s=n.pitOutLineBeforeStart,a=n.minTotalPitMinute,b=n.minPitSeconds,i=n.maxPitSeconds,c=r.minDriverChange,m=N(u,e,o,s),f=C(u,s),d=S(m,f,a,c,b,i,o);postMessage({pitDoneByRaceNumber:f,remainingPitByRaceNumber:d.remainingPitByRaceNumber,remainingPitTimeMillisecondsByRaceNumber:d.remainingPitTimeMillisecondsByRaceNumber})});function N(t,u,e,n){let r=new Map,p=n?e:Math.round(e/2);return t.forEach(o=>{let s=u.get(o.raceNumber),a=o.lapMilliseconds-(s||0)-p;r.has(o.raceNumber)||r.set(o.raceNumber,a),r.set(o.raceNumber,r.get(o.raceNumber)+a)}),r}function C(t,u){let e=new Map;return t.forEach(n=>{e.has(n.raceNumber)||e.set(n.raceNumber,0),e.set(n.raceNumber,e.get(n.raceNumber)+1)}),e.forEach((n,r)=>{u?e.set(r,n):e.set(r,Math.round(n/2))}),e}function S(t,u,e,n,r,p,o){let s=new Map,a=new Map;return t.forEach((b,i)=>{let c=0;if(e>0)if(c=I(e)-b,c<=0)a.set(i,0),s.set(i,0);else{let m=0;o===0?s.set(i,c):o<0?m=Math.round(c/l(r)):o>0&&(m=Math.round(c/l(p))),a.set(i,m),c+=m*o,s.set(i,c)}else{let m=0;u.get(i)&&(m=n-u.get(i)),m<=0?(a.set(i,0),s.set(i,0)):(a.set(i,m),c=m*(l(r)+o),s.set(i,c))}}),{remainingPitTimeMillisecondsByRaceNumber:s,remainingPitByRaceNumber:a}}
