import{k as S}from"./chunk-QB5SOPTM.js";import{a as b,l as h,q as v,r as y}from"./chunk-IGED4TOA.js";import{M as d,N as a,Z as g,aa as m,ba as f}from"./chunk-Q6UHPJXR.js";import{N as u,R as l,X as s,sa as o,t as p,u as n}from"./chunk-7TD4AYMG.js";var M=class t{teamService=s(v);lapService=s(y);racePositionService=s(S);worker;gapAheadMilliseconds=o(void 0);gapBehindMilliseconds=o(void 0);constructor(){typeof Worker<"u"&&(this.worker=new Worker(new URL("worker-7CR4DGOX.js",import.meta.url),{type:"module"}),this.worker.onmessage=({data:r})=>{this.gapAheadMilliseconds.set(r.gapAheadMilliseconds),this.gapBehindMilliseconds.set(r.gapBehindMilliseconds)}),n({cumulatedTimeByRaceNumber:a(this.lapService.cumulatedTimeByRaceNumber),lastLapNumberByRaceNumber:a(this.lapService.lastLapNumberByRaceNumber),racePositionByRaceNumber:a(this.racePositionService.racePositionByRaceNumber),activeTeam:a(this.teamService.activeTeam)}).pipe(d()).subscribe(({cumulatedTimeByRaceNumber:r,lastLapNumberByRaceNumber:e,racePositionByRaceNumber:i,activeTeam:c})=>{this.worker&&this.worker.postMessage({cumulatedTimeByRaceNumber:r,lastLapNumberByRaceNumber:e,racePositionByRaceNumber:i,activeTeam:c})})}static \u0275fac=function(e){return new(e||t)};static \u0275prov=l({token:t,factory:t.\u0275fac,providedIn:"root"})};var W=class t extends b{collectionPath="/steering-wheel-message-updates";collectionRef=f(this.firestore,this.collectionPath);raceService=s(h);steeringWheelMessageUpdate=o(void 0);constructor(){super(),n({steeringWheelMessageUpdate:this.getSteeringWheelMessageUpdate()}).pipe(d()).subscribe(({steeringWheelMessageUpdate:r})=>{if(r){let e=this.steeringWheelMessageUpdate();(!e||e.updatedAt<r.updatedAt)&&this.steeringWheelMessageUpdate.set(r)}})}updateMessageType(r){let e=this.steeringWheelMessageUpdate(),i=this.raceService.activeRace();if(i===void 0){this.notificationService.info("No active race");return}e||(e={id:i.id,deleted:!1,raceId:i.id,type:r.type,updatedAt:g.now()}),e&&(e.type=r.type,e.updatedAt=g.now(),e.deleted=!1,this.updateDataWithMessage(e.id,e,"message type"))}getSteeringWheelMessageUpdate(){return n({steeringWheelMessageUpdates:m(this.collectionRef),activeRace:a(this.raceService.activeRace)}).pipe(u(this.destroyed),p(({steeringWheelMessageUpdates:r,activeRace:e})=>{let i=r;if(e&&i.length>0)return i.filter(c=>!c.deleted&&c.raceId===e.id).at(0)}))}static \u0275fac=function(e){return new(e||t)};static \u0275prov=l({token:t,factory:t.\u0275fac,providedIn:"root"})};function V(t){switch(t.type){case"box":return"BOX";case"safety-car":return"SAFETY CAR";case"fast-driver-behind":return"FAST DRIVER BEHIND"}}function Y(t){switch(t.type){case"box":return"bg-orange-500";case"safety-car":return"bg-yellow-500";case"fast-driver-behind":return"bg-blue-500"}}function q(t){return"text-neutral-900"}function z(t){return"bg-neutral-900"}function J(t){switch(t.type){case"box":return"text-orange-500";case"safety-car":return"text-yellow-500";case"fast-driver-behind":return"text-blue-500"}}function K(t){switch(t.type){case"box":return"bg-orange-500 hover:bg-orange-700 disabled:bg-orange-200";case"safety-car":return"bg-yellow-500 hover:bg-yellow-700 disabled:bg-yellow-200";case"fast-driver-behind":return"bg-blue-500 hover:bg-blue-700 disabled:bg-blue-200"}}export{M as a,W as b,V as c,Y as d,q as e,z as f,J as g,K as h};
