var P=Math.pow(10,8)*24*60*60*1e3,z=-P;var M=36e5,S=1e3;var b=3600;var y=b*24,E=y*7,v=y*365.2425,R=v/12,N=R*3,g=Symbol.for("constructDateFrom");function u(n,e){return typeof n=="function"?n(e):n&&typeof n=="object"&&g in n?n[g](e):n instanceof Date?new n.constructor(e):new Date(e)}function c(n,e){return u(e||n,n)}function p(n,e,t){return u(t?.in||n,+c(n)+e)}function T(n,e,t){return p(n,e*M,t)}function w(n,e,t){return p(n,e*1e3,t)}function I(n,e){return+c(n)-+c(e)}function D(n){return n*S}addEventListener("message",({data:n})=>{let e=n.activeRace,t=n.willEndRaceDate!==void 0?n.willEndRaceDate:void 0,o=n.remainingDriverChanges,r=n.remainingTyreChange,i=n.lastPit,m=n.raceConfig,a=n.lapConfig,f=n.pitConfig,d=a.referenceLapTimeMillisecond,l=m.durationHour,s=F(e,e?e.startedAt:new Date,t||T(new Date,l),o,r,i,f,d);postMessage({optimizedStint:s})});function F(n,e,t,o,r,i,m,a){let f=new Date;if(f>=t)return;let d=H(m,o,r),l=I(t,f)-d,s;i&&(i.exitAt?s=i.exitAt:s=w(i.entryAt,m.minPitSeconds));let C=(I(t,s||e)-d)/(o+1),x=0,h=0;return o>0&&n!==void 0&&(x=l/o,h=Math.floor(x/a)),{avgStintMillisecondsTime:C,laps:Math.floor(C/a),avgStintMillisecondsIfDriverChangedNow:x,lapsIfDriverChangeNow:h}}function H(n,e,t){let o=e-t,r=D(n.minPitSeconds*o),i=D(n.minPitWithTyreChangeSeconds*t);return r+i}
